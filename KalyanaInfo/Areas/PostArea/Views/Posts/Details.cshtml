@model KalyanaInfo.Models.Post

@{
    ViewData["Title"] = "Details";
}

<h1>Post</h1>
@if (!string.IsNullOrEmpty(Context.Session.GetString("name")))
{
    <p>
        <a asp-action="Create">
            <div class="text-center">
                <img src="~/Images/PersonImages/@Context.Session.GetString("img")" style="height:60px;width:60px;border-radius:50%;margin-right:8px" />
                <input type="text" disabled placeholder="Whats in your mind" style="border-radius:20px" />
            </div>
        </a>
    </p>
}

<div class="card mb-3" id="PostDiv">
    <div>
        <h6 class="card-header"><img src="~/Images/PersonImages/@Model.User.Image" style="height:60px;width:60px;border-radius:50%;margin-right:4px" />@Html.DisplayFor(model => model.User.Name)<br><span>@Model.User.Name<br></span><span>@DateTime.Now.Subtract(Model.CreatedDate).Days :@DateTime.Now.Subtract(Model.CreatedDate).Hours :@DateTime.Now.Subtract(Model.CreatedDate).Minutes   <span>minuts ago</span></span></h6>

    </div>
    <div class="card-body">
        @if (!(string.IsNullOrEmpty(Model.Title) || Model.Title.Equals("notitle")))
        {
            <p class="card-text"><b>@Model.Title</b></p>
        }
        <p class="card-text">@Model.Description</p>
    </div>
    @if (!Model.Images.Equals("noimage"))
    {
        <img style="height: 200px; width: 99%; display: block;" src="~/Images/PostImages/@Model.Images" alt="Card image">
    }
    @if (!Model.Video.Equals("novideo"))
    {
        <video style="height: 200px; width: 99%; display: block;" src="~/Videos/PostVideos/@Model.Video" controls autoplay></video>
    }
    <div class="card-body">
        @if ((Context.Session.GetInt32("id")) == Model.UserId)
        {
            <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-secondary">Edit</a>
            <a class="btn btn-danger" data-toggle="modal" data-target="#exampleModal-@Model.Id">Delete</a>
        }
        <a asp-action="Index" class="btn btn-secondary">Back</a>

        <a class="btn btn-primary" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
            <span class="fa fa-share"></span>
        </a>
        <div class="collapse" id="collapseExample">
            <div class="card card-body">
                <div class="sharethis-inline-share-buttons"></div>
            </div>
        </div>


    </div>

</div>

<!-- Button trigger modal -->
<!-- Modal -->
<div class="modal" id="exampleModal-@Model.Id" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">
                ...
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="delbutton">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div id="disqus_thread"></div>
@section Scripts
{

    <script>

        /**
        *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
        *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

        var disqus_config = function () {
        this.page.url = @Context.Request.Host@Context.Request.Path;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = @Model.Id; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };

        (function () { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://kalyanainfo-azurewebsites-net.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <script>
        $(function () {

            $("#delbutton").click(function () {

                $.ajax({
                url: '/PostArea/Posts/DeletePost',
                type: 'POST',
                data: {
                    id:@Model.Id
                },
                success: function (returndata)
                {
                    if (returndata == "1")
                    {
                        $("#PostDiv").hide();

                        $("#exampleModal-@Model.Id").modal('hide');
                    } else
                    {
                        alert("Not Found");
                    }
                },
                Error: function (er) {
                    alert(er)
                }



            })
           });

        });


    </script>


}